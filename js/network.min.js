urls={proxy:"http://b2-apps.appspot.com/",api:"www.thetvdb.com/api/",id:"C973590B1E212580",banner:"www.thetvdb.com/banners/",search:"GetSeries.php",update:"https://dl.dropbox.com/u/51320501/tv-version.json"};tv.network={};tv.status=0;tv.network.searchShow=function(e){var t=urls.proxy+urls.api+urls.search;$.get(t,{seriesname:e},tv.ui.showSearchList)};tv.network.getShow=function(e){var t=urls.proxy+urls.api+urls.id+"/series/"+e+"/en.xml";window.addEventListener("beforeunload",tv.network.progressError,false);$.get(t,tv.ui.addShow)};tv.network.getEpisodes=function(e){var t=urls.proxy+urls.api+urls.id+"/series/"+e+"/all/en.xml";$.get(t,tv.ui.addEpisodes)};tv.network.updateEpisode=function(e,t){var n=urls.proxy+urls.api+urls.id+"/episodes/"+e+"/en.xml";$.get(n,function(e){var n={};$(e).find("Episode").each(function(){n.name=$(this).find("EpisodeName").text();n.showname=t;n.showid=$(this).find("seriesid").text();n.episodeID=$(this).find("id").text();n.overview=$(this).find("Overview").text();n.guestStars=$(this).find("GuestStars").text();n.airdate=$(this).find("FirstAired").text();n.season=$(this).find("SeasonNumber").text();n.episode=$(this).find("EpisodeNumber").text();n.lastUpdated=$(this).find("lastupdated").text()});tv.indexedDB.updateEpisode(n)})};tv.network.error=function(e){bootbox.alert("Error while searching.")};tv.network.progressError=function(){return"File download in progress."};tv.network.getPoster=function(e){var t=urls.proxy+urls.banner+e.poster;var n=new Image;n.addEventListener("load",function(t){window.removeEventListener("beforeunload",tv.network.progressError,false);var r=tv.ui.getDataUrl(n);var i={};i.showid=e.showid;i.poster=r;tv.indexedDB.savePoster(i);$("#loadingBar").hide()});n.src=t}